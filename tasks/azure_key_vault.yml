# Azure Key Vault Task Wrapper
# Wraps Microsoft Azure DevOps Azure Key Vault task for standardised CI/CD usage
# https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-key-vault

parameters:
  - name: KeyVaultServiceConnection
    type: string
    default: ''
    displayName: 'Azure Subscription'

  - name: KeyVaultName
    type: string
    default: ''
    displayName: 'Key Vault'

  - name: SecretsFilter
    type: string
    default: '*'
    displayName: 'Secrets Filter'

  - name: RunAsPreJob
    type: boolean
    default: false
    displayName: 'Run As Pre-Job'

steps:
  - task: AzureKeyVault@2
    displayName: 'Azure Key Vault: ${{ parameters.KeyVaultName }}'
    inputs:
      azureSubscription: ${{ parameters.KeyVaultServiceConnection }}
      KeyVaultName: ${{ parameters.KeyVaultName }}
      SecretsFilter: ${{ parameters.SecretsFilter }}
      RunAsPreJob: ${{ parameters.RunAsPreJob }}
