# Publish Pipeline Artifact Task Template
#
# Wraps: PublishPipelineArtifact@1 (Built-in Azure DevOps task)
# Purpose: Publishes build artifacts to Azure DevOps pipeline storage with consistent parameter handling
#
# Usage Examples:
#   - template: ../tasks/publish_pipeline_artifact.yml
#     parameters:
#       ArtifactName: 'terraform-files'
#       TargetPath: '$(Build.SourcesDirectory)/terraform'
#
#   - template: ../tasks/publish_pipeline_artifact.yml
#     parameters:
#       ArtifactName: 'build-output'
#       TargetPath: '$(Build.ArtifactStagingDirectory)'
#       Parallel: true
#
#   - template: ../tasks/publish_pipeline_artifact.yml
#     parameters:
#       ArtifactName: 'container-artifact'
#       TargetPath: './dist'
#       PublishLocation: 'container'
#
# Known Issues:
# - None known - this is a standard Azure DevOps built-in task wrapper

parameters:
  - name: ArtifactName
    type: string
    default: 'drop'
    displayName: 'Name of the artifact to publish'

  - name: TargetPath
    type: string
    default: '$(Pipeline.Workspace)'
    displayName: 'Path to files or folder to publish'

  - name: PublishLocation
    type: string
    values: [ pipeline, container ]
    default: 'pipeline'
    displayName: 'Artifact publish location'

  - name: Parallel
    type: boolean
    default: false
    displayName: 'Upload files in parallel'

  - name: Properties
    type: string
    default: ''
    displayName: 'Custom properties for the artifact'

steps:
  - task: PublishPipelineArtifact@1
    displayName: "Publish Pipeline Artifact '${{ parameters.ArtifactName }}'"
    inputs:
      artifact: ${{ parameters.ArtifactName }}
      targetPath: ${{ parameters.TargetPath }}
      publishLocation: ${{ parameters.PublishLocation }}
      parallel: ${{ parameters.Parallel }}

      # Optional parameters with conditional inclusion
      ${{ if ne(parameters.Properties, '') }}:
        properties: ${{ parameters.Properties }}
