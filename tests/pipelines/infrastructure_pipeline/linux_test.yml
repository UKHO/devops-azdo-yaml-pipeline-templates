resources:
  repositories:
    - repository: PipelineTemplates
      type: github
      endpoint: UKHO
      name: UKHO/devops-azdo-yaml-pipeline-templates
      ref: refs/heads/terraform-deploy

pool: $(PipelinePool) # Variable defined within template, overridable via template parameter 'PipelinePool'.

extends:
  template: pipelines/infrastructure_pipeline.yml@PipelineTemplates
  parameters:
    # PipelinePool # do not need to test
    RelativePathToTerraformFiles: tests/pipelines/infrastructure_pipeline/test_terraform
    TerraformVersion: 1.13.5
    # TerraformBuildInjectionSteps # do not need to test
    AzDOEnvironmentName: Discovery
    AzureSubscriptionServiceConnection: Pipeline-CloudDisco
    # DeploymentJobsVariableMappings # todo configure this for testing
    BackendAzureServiceConnection: Pipeline-CloudDisco # ?
    BackendAzureResourceGroupName: m-devopschapter-rg
    BackendAzureStorageAccountName: ukhodoctfstatesa
    BackendAzureContainerName: tfstate
    BackendAzureBlobName: linux_test.tfstate
    # KeyVaultServiceConnection: Pipeline-CloudDisco
    # KeyVaultName: aKV
    # KeyVaultSecretsFilter: "aSecretFilter"
    # RunPlanOnly: true
    # TerraformVariableMappings # todo configure this
    # TerraformOutputVariables # todo configure this
    # TerraformVariableFiles # todo configure this


